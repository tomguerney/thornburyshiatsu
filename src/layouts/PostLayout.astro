---
import Layout from './Layout.astro';

const { title, pubDate, description } = Astro.props;

// Format the publication date for display (fallback to raw string if invalid)
let formattedDate = '';
if (pubDate) {
  try {
    const d = new Date(pubDate);
    if (!Number.isNaN(d.getTime())) {
      formattedDate = d.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
    } else {
      formattedDate = String(pubDate);
    }
  } catch (e) {
    formattedDate = String(pubDate);
  }
}
---

<Layout title={title || 'Post'} description={description || ''}>
  <section class="py-16 sm:py-20">
    <div class="mx-auto max-w-2xl px-4 sm:px-6 lg:max-w-7xl lg:px-8">
      <div class="mx-auto max-w-2xl">
        <header class="mb-8">
          {title && <h1 class="text-4xl font-medium tracking-tight text-primary-900 dark:text-primary-100 sm:text-5xl mb-2">{title}</h1>}
          {formattedDate && <p class="text-primary-700 dark:text-primary-300 text-base">{formattedDate}</p>}
        </header>

        <article class="prose prose-lg prose-primary dark:prose-invert max-w-none post-content leading-relaxed">
          <slot />
        </article>
      </div>
    </div>
  </section>
  <style is:global>
    /* Ensure consistent vertical rhythm between markdown block elements inside posts */
    .post-content > * + * {
      margin-top: 1.25rem; /* 20px */
    }
    /* Slightly increase spacing after headings inside posts */
    .post-content h1 + *,
    .post-content h2 + *,
    .post-content h3 + * {
      margin-top: 0.75rem;
    }
  </style>
</Layout>
